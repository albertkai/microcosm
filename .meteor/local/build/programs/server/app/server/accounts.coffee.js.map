{"version":3,"file":"/server/accounts.coffee.js","sources":["accounts.coffee"],"names":[],"mappings":"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","sourcesContent":["Accounts.onCreateUser (options, user)->\n\n  if !user.profile\n    user['profile'] = {}\n  user.profile['avatar'] = \"http://graph.facebook.com/\" + user.services.facebook.id + \"/picture/?type=large\"\n  requested = ['email', 'gender', 'first_name', 'last_name', 'locale']\n  requested.forEach (name)->\n    user.profile[name] = user.services.facebook[name]\n  user.profile['registration'] = {}\n  user.profile['tests'] = {}\n  user.profile['customize'] = {}\n  user.profile['com'] = {}\n  user.profile.com['messenger'] = {}\n  user.profile.com.messenger['threads'] = []\n  user.profile.com.messenger['count'] = 0\n  user.profile.customize['backgroundPic'] = 'sample_shanghai.jpg'\n  user.profile.com['friends'] = []\n  user.profile.com['likes'] = []\n  user.profile.com['bookmarks'] = []\n  user.profile.registration['status'] = 'justRegistered'\n  user.profile.registration['step'] = ''\n  user.profile.registration['breakOne'] = true\n  user.profile.registration['breakTwo'] = true\n  user.profile.services = user.services\n\n  generateThread = {\n    members: [\n      {\n        id: 'nLNB5tGfPiNQkwgAy',\n        firstName: 'Ваш',\n        lastName: 'Microcosm',\n        first_name: 'Your',\n        last_name: 'Microcosm',\n        avatar: 'http://graph.facebook.com/1276327615/picture/?type=large'\n      },\n      {\n        id: user._id,\n        firstName: user.services.facebook.first_name,\n        lastName: user.services.facebook.last_name,\n        first_name: user.services.facebook.first_name,\n        last_name: user.services.facebook.last_name,\n        avatar: \"http://graph.facebook.com/\" + user.services.facebook.id + \"/picture/?type=large\"\n      }]\n    lastMessage: {\n      date: new Date()\n      message: 'Приветствую! Очень рады тебя видеть среди нас!!'\n      type: 'text'\n    }\n    createdAt: new Date()\n    messages: [\n      {\n        id: 'nLNB5tGfPiNQkwgAy'\n        date: new Date()\n        type: 'text'\n        message: 'Привет! Добро пожаловать на наш проект! Очень рады видеть тебя среди нас! Так как ты только что зарегистрировался, можешь задавать мне в эту переписки вопросы по поводу того, как пользоваться сервисом, и я отвечу в ближайшее время! Рады видеть тебя здесь с нами=)'\n        attach: false\n      }\n    ]\n    type: 'mixed',\n    count: 0\n  }\n\n  f = new Future()\n\n  Threads.insert generateThread, (err, res)->\n\n    console.log 'thread inserted, id is: ' + res\n\n    message = {\n      threadId: res\n      members: [\n        {\n          id: 'rf4pFXbkTJT5YKaGu',\n          firstName: 'Ваш',\n          lastName: 'Microcosm',\n          first_name: 'Your',\n          last_name: 'Microcosm',\n          avatar: 'http://graph.facebook.com/1276327615/picture/?type=large'\n        }\n      ]\n      createdAt: 'Thu Aug 28 2014 18:45:56 GMT+0400 (MSK)'\n      lastMessage: {\n        date: 'Thu Aug 28 2014 18:45:56 GMT+0400 (MSK)'\n        type: 'text'\n        message: 'Привет! Добро пожаловать на наш проект! Очень рады видеть тебя среди нас! '\n      }\n    }\n    user.profile.com.messenger.threads.push message\n    f.return(user)\n\n  f.wait()\n"]}