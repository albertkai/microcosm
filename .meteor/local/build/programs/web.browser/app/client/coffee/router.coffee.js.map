)]}'
{"version":3,"file":"/client/coffee/router.coffee.js","sources":["router.coffee"],"names":[],"mappings":"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","sourcesContent":["Router.configure {\n  notFoundTemplate: 'notFound'\n  loadingTemplate: 'loading'\n}\n\nRouter.onBeforeAction ->\n  if Response.deviceW() < 900\n    @go 'mobile'\n\nRouter.onBeforeAction (pause)->\n  if !@ready\n    log 'loading'\n    @render 'loading'\n    pause()\n\n\nRouter.map ->\n\n  @route 'base', {\n    path: '/'\n    waitOn: ->\n      Meteor.subscribe('users')\n#    onBeforeAction: ->\n#      if !Meteor.loggingIn() and !Meteor.user()\n#        @redirect 'hello'\n    action: ->\n      if Meteor.userId() && Meteor.user()\n        user = Meteor.user()\n        console.log 'youLogged'\n        status = user.profile.registration.status\n        if status is 'tested'\n          log 'redirecting to username from base route'\n          username = user.profile.username\n          @redirect '/' + username\n        else\n          log 'redirecting to registration/hello from base route'\n          @redirect 'registration/hello'\n      else\n        @redirect 'hello'\n  }\n\n  @route 'hello', {\n    template: 'hello'\n    onBeforeAction: ->\n      if Meteor.user()\n        @redirect '/'\n  }\n\n  @route 'registration', {\n    layoutTemplate: 'registration'\n    action: ->\n      if !Meteor.user()\n        Router.go 'base'\n      else\n#        @render()\n  }\n\n  @route 'mobile'\n\n  @route 'registration/hello', {\n    layoutTemplate: 'registrationLayout'\n    template: 'registration'\n    waitOn: ->\n      Meteor.subscribe('users')\n    action: ->\n      if !Meteor.user()\n        log 'redirecting to base'\n        Router.go 'base'\n      else\n        log Meteor.user()\n        @render()\n#        log 'registration/hello, found user'\n#        status = Meteor.user().profile.registration.status\n#        if status is \"justRegistered\"\n#          log 'router is rendering info template from action'\n#          UI.insert UI.render(Template.info), $('#info-insert').get(0)\n#        else if status is \"testing\"\n#          log 'router is rendering testing template from action'\n#          $('.reg-step').find('>div').removeClass '_active'\n#          $('.reg-step').find('>div').eq(1).addClass '_active'\n#          marginTop = 0 - $(window).height()\n#          $('.registration').find('.info').css('margin-top', marginTop + 'px')\n#          UI.insert UI.render(Template.testing_cont), $('#testing-insert').get(0)\n  }\n\n\n\n  @route 'profile', {\n    path: '/:username'\n    layoutTemplate: 'mainLayout'\n    template: 'profile'\n    waitOn: ->\n      Meteor.subscribe('users')\n    data: ->\n      if Meteor.userId() && Meteor.user()\n        user = Meteor.users.findOne({'profile.username': @params.username})\n        profile = user.profile\n        id = user._id\n        {\n          profile: profile\n          userId: id\n        }\n    action: ->\n\n      if Meteor.userId()\n        Session.set('currentUsersPage', @params.username)\n        log 'session set!!'\n        log Session.get('currentUsersPage')\n        @render()\n  }\n\n  @route 'johari', {\n\n    path: 'johari/:id'\n    template: 'johariAside'\n\n    waitOn: ->\n      Meteor.subscribe('users')\n\n    data: ->\n      id = @params.id\n      user = Meteor.users.findOne @params.id\n      {\n        name: user.profile.firstName\n        id: id\n      }\n\n    action: ->\n      if Meteor.user()\n        id = Meteor.user()._id\n        if @params.id is id\n          @redirect \"johariYours\"\n      else\n        @render()\n\n  }\n\n  @route 'johariYours'\n\n  @route 'settings', {\n\n    action: ->\n\n      MainCtrl.modal.open()\n\n  }"]}